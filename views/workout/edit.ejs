<!DOCTYPE html>
<html lang="en">

<%- include('../partials/head'); %>

<% const daysOfTheWeek = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday']; %>

<body>
    <div class="container-fluid">
        <%- include('../partials/nav'); %>
        <div class="container">
            <h2>Edit Workout</h2>
            <form action="/workouts/<%= workout._id %>?_method=PUT" method="POST">
                <div class="row">
                    <div>
                        <p class="fs-6 fst-italic">Select Day:</p>
                        <select name="day" class="form-select form-select-lg" size="4" required>
                            <% for (const day of daysOfTheWeek) { %>
                                <option value="<%= day %>" <% if (workout.day === day) { %> selected<% } %>>
                                    <%= day %>
                                </option>
                            <% } %>
                        </select>
                    </div>
                </div>
                <h4 class="mt-4">Exercise Details</h4>
                <div class="workoutInputParent">
                    <% displayExercise(0, movements); %>
                    <% function displayExercise (exerciseIndex, movements) { %>
                        <% if (exerciseIndex === workout.exercise.length) return; %>

                        <% const exercise = workout.exercise[exerciseIndex] %>

                        <div class="workoutInputChild">
                            <div class="index">
                                <div class="p-3">
                                    <p class="fs-6 fst-italic">Select Movement:</p>
                                    <select name="exercise[movement][]" class="form-select movementSelect" size="7" required>
                                        <% for (const movement of movements) { %>
                                            <option class="text-capitalize" value="<%= movement._id %>" data-type="<%= movement.type %>"
                                                <% if (exercise.movement.name === movement.name) { %> selected <% } %>>
                                                <%= movement.name %>
                                            </option>
                                        <% } %>
                                    </select>
                                </div>
                                <div class="right mt-5">
                                    <div class="form-floating weightedSection">
                                        <div class="form-floating">
                                            <input type="number" name="exercise[weight][]" min="0" class="form-control mb-1" id="weight" value="<%= exercise.weight %>">
                                            <label for="weight">Weight</label>
                                        </div>
                                        <div class="form-floating">
                                            <input type="number" name="exercise[sets][]" min="1" class="form-control mb-1" id="sets" value="<%= exercise.sets %>">
                                            <label for="sets">Sets</label>
                                        </div>
                                        <div class="form-floating">
                                            <input type="number" name="exercise[reps][]" min="1" class="form-control mb-1" id="reps" value="<%= exercise.reps %>">
                                            <label for="reps">Repetitions per Set</label>
                                        </div>
                                    </div>
                                    <div class="form-floating cardioSection">
                                        <div class="form-floating">
                                            <input type="number" name="exercise[minutes][]" min="1" class="form-control mb-1" id="minutes" value="<%= exercise.minutes %>">
                                            <label for="reps">Minutes</label>
                                        </div>
                                        <div class="form-floating">
                                            <input type="number" name="exercise[caloriesBurned][]" min="1" class="form-control" id="calories" value="<%= exercise.caloriesBurned %>">
                                            <label for="reps">Calories Burned</label>
                                        </div>
                                    </div>
                                    <br>
                                    <p class="btn btn-outline-danger btn-sm delete">Delete Exercise</p>
                                </div>
                            </div>
                            <br>
                        </div>
                        <% displayExercise(exerciseIndex + 1, movements); %>
                    <% } %>
                </div>
                <div class="mb-3 right">
                    <p class="btn btn-outline-success btn-sm add">Add Another Exercise</p>
                </div>
                <div class="mb-5 center">
                    <input type="submit" value="Update Workout" class="btn btn-outline-secondary btn-lg mb-5 workoutSubmit">
                </div>
            </form>
        </div>
    </div>
    <%- include('../partials/footer'); %>
</body>

</html>